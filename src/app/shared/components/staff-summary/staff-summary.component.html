<div class="govuk-grid-row govuk-util__vertical-align-center">
  <div class="govuk-grid-column-three-quarters">
    <app-search-input accessibleLabel="for staff records" (emitInput)="handleSearch($event)"></app-search-input>
  </div>

  <div class="govuk-grid-column-one-quarter govuk-!-margin-bottom-0 govuk-!-padding-top-2 govuk-!-padding-bottom-2">
    <div class="govuk-form-group">
      <label class="govuk-label" for="sortByStaff"> Sort by </label>
      <select class="govuk-select" id="sortByStaff" name="sortByStaff" (change)="sortBy($event.target.value)">
        <option *ngFor="let sortStaffOption of sortStaffOptions | keyvalue" value="{{ sortStaffOption.key }}">
          {{ sortStaffOption.value }}
        </option>
      </select>
    </div>
  </div>
</div>
<table *ngIf="workerCount; else noWorkersFound" class="govuk-table">
  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th class="govuk-table__header" scope="col">Staff name</th>
      <th class="govuk-table__header" scope="col">Job role</th>
      <th class="govuk-table__header" scope="col">Last updated</th>
      <th *ngIf="!wdfView" class="govuk-table__header" scope="col">
        <span class="govuk-visually-hidden">Status</span>
      </th>
      <th *ngIf="wdfView" class="govuk-table__header" scope="col">WDF requirements</th>
    </tr>
  </thead>
  <tbody class="govuk-table__body">
    <tr class="govuk-table__row" *ngFor="let worker of paginatedWorkers">
      <td class="govuk-table__cell govuk-!-font-weight-regular">
        <ng-container *ngIf="canViewWorker; else nameOrId">
          <a [routerLink]="getWorkerRecordPath(worker)">
            {{ worker.nameOrId }}
          </a>
        </ng-container>
        <ng-template #nameOrId>
          {{ worker.nameOrId }}
        </ng-template>
      </td>
      <td class="govuk-table__cell">{{ worker.jobRole }}</td>
      <td class="govuk-table__cell">
        <span class="govuk-visually-hidden">last updated</span>
        <span class="govuk__nowrap">{{ lastUpdated(worker.updated) }}</span>
      </td>
      <td *ngIf="!wdfView" class="govuk-table__cell">
        <a
          *ngIf="canEditWorker && !worker.completed"
          class="govuk-util__float-right"
          [routerLink]="[
            '/workplace',
            workplace.uid,
            'staff-record',
            worker.uid,
            worker.mainJob?.jobId === 27 ? 'mental-health-professional' : 'main-job-start-date'
          ]"
          [state]="{ navigatedFrom: 'staff-records' }"
          >Add more details <span class="govuk-visually-hidden"> for {{ worker.nameOrId }}</span></a
        >
      </td>
      <td *ngIf="wdfView" class="govuk-table__cell">
        <span class="govuk-visually-hidden">{{ worker.nameOrId }} is</span>
        <app-eligibility-icon [eligible]="worker.wdfEligible"></app-eligibility-icon>
      </td>
    </tr>
  </tbody>
</table>
<ng-template #noWorkersFound>
  <p class="govuk-util__bold">There are no matching results.</p>
  <p>Make sure that your spelling is correct.</p>
</ng-template>
<app-pagination
  [itemsPerPage]="itemsPerPage"
  [totalNoOfItems]="workerCount"
  (emitCurrentPage)="handlePageUpdate($event)"
  [currentPageIndex]="currentPageIndex"
></app-pagination>
