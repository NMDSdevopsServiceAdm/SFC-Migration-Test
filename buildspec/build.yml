version: 0.2

run-as: codebuild-user

env:
  variables:
    NODE_OPTIONS: "--max_old_space_size=8192"
phases:
  # install:
  #   runtime-versions:
  #     nodejs: 18
  pre_build:
    commands:
      - curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash
      - nvm install 16
      - nvm use 16
  build:
    commands:
      - cd frontend && npm ci
      - npm run build:test
      - cd ../backend && npm ci